<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <script src="common.js"></script>
  </head>
  <body>
    <script>
      var csvToArray = csvStr => csvStr.split('\n').map(arr => arr.split(','));
      var csvArr = csvToArray(csvString);
      // console.log(csvArr);

      //=========== findAverageAgeOrSalary of array ============//

      function findAverageAgeOrSallary(gender, skill, avgType, arr) {
        var filtered = arr.filter(
          developer =>
            (developer[4] === gender || gender === 'all') &&
            (developer[3] === skill || skill === 'all')
        );

        console.log(
          `There are ${filtered.length} ${gender === 'all' ? '' : gender} ${
            skill === 'all' ? '' : skill
          } developers with average ${avgType.toUpperCase()}: `
        );

        var reducedAvg = filtered.reduce((acc, dev, _, arr) => {
          if (avgType === 'age') {
            avgType = 2020 - parseInt(dev[0]);
          } else if (avgType === 'sallary') {
            avgType = parseInt(dev[5]);
          }
          acc += avgType;
          return acc;
        }, 0);

        return reducedAvg / filtered.length;
      }
/*
      console.log(findAverageAgeOrSallary('all', 'all', 'age', csvArr));
      console.log(findAverageAgeOrSallary('male', 'all', 'age', csvArr));
      console.log(findAverageAgeOrSallary('female', 'all', 'age', csvArr));
      console.log(findAverageAgeOrSallary('all', 'frontend', 'age', csvArr));
      console.log(findAverageAgeOrSallary('all', 'backend', 'age', csvArr));
      console.log(findAverageAgeOrSallary('all', 'fullstack', 'age', csvArr));
      console.log(findAverageAgeOrSallary('male', 'frontend', 'age', csvArr));
      console.log(findAverageAgeOrSallary('male', 'backend', 'age', csvArr));
      console.log(findAverageAgeOrSallary('male', 'fullstack', 'age', csvArr));
      console.log(findAverageAgeOrSallary('female', 'frontend', 'age', csvArr));
      console.log(findAverageAgeOrSallary('female', 'backend', 'age', csvArr));
      console.log(findAverageAgeOrSallary('female', 'fullstack', 'age', csvArr));

      console.log(findAverageAgeOrSallary('all', 'all', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('male', 'all', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('female', 'all', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('all', 'frontend', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('all', 'backend', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('all', 'fullstack', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('male', 'frontend', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('male', 'backend', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('male', 'fullstack', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('female', 'frontend', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('female', 'backend', 'sallary', csvArr));
      console.log(findAverageAgeOrSallary('female', 'fullstack', 'sallary', csvArr));
    */
      //=================================== SortArrays ========================//

      var sortedDeveloper = (sortBy, sortDir, obj) => {
        if (sortBy === 'age') {
          sortBy = 0;
        } else if (sortBy === 'sallary') {
          sortBy = 5;
        }

        var sortedAsc = obj.sort((a, b) => a[sortBy] - b[sortBy]).slice();
        var sortedDesc = obj.sort((a, b) => b[sortBy] - a[sortBy]).slice();
        return sortDir === 'desc' ? sortedDesc : sortDir === 'asc' ? sortedAsc : 'no valid input';
      };

      //   console.log(sortedDeveloper('age', 'desc', csvArr));
      //   console.log(sortedDeveloper('age', 'asc', csvArr));
      //   console.log(sortedDeveloper('sallary', 'asc', csvArr));
      //   console.log(sortedDeveloper('sallary', 'desc', csvArr));

      //=================================== developersByGender from array ========================//


     var  developersByGenderFromArray = (gender) => {
      var filterDev = csvArr.filter(dev =>
       gender === undefined || dev[4] === gender);

       return filterDev.reduce((acc, dev,i,arr) => {
          acc[dev].push(dev)
          return acc
        }, [
         [], [], []
       ]
       )
     }

    //  console.log(developersByGenderFromArray('male'));
     







     var developersByGender = gender => {
        var filterDev = csvArr.filter
        (dev => gender === undefined || dev.gender === gender);
        var reducedDevByskill = filterDev.reduce(
          (acc, current) => {
            acc[current.skill].push(current);
            return acc;
          },
          {
            frontend: [],
            backend: [],
            fullstack: []
          }
        );
        console.log('Developers By Gender: ' + (gender === undefined ? 'all' : gender).toUpperCase());
        return reducedDevByskill;
      };
     console.log(developersByGender('male'));

    </script>
  </body>
</html>
